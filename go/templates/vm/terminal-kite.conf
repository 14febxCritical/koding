# Ubuntu upstart file. Put at /etc/init/terminal-kite.conf
# After putting it into /etc/init do the following for initialization:
#
#   sudo initctl reload-configuration
#   sudo initctl list
#
# you should see terminal-kite in the list, if not something is wrong. After that start it:
#
#   start terminal-kite
#
# log is stored at /var/log/kites/terminal-kite.log. To see the log in realtime you can use:
#
#   tail -f /var/log/terminal-kite
#
description "terminal-kite"

respawn
respawn limit 15 5

pre-start script
    logger "creating log dir for kites"
    mkdir -p /var/log/kites/
end script

start on (net-device-up
          and local-filesystems
          and runlevel [2345])
stop on runlevel [!2345]

script
exec sudo -i -u \#{{.Uid}} -- terminal-kite --port 4001 2>&1 > /var/log/kites/terminal-kite.log
end script

# This works too.. We use for uid for gid
# exec start-stop-daemon --start -c {{.Uid}}:{{.Uid}}  --exec /usr/bin/fs-kite -- --port 4001

respawn limit 15 5