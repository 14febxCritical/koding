// Generated by CoffeeScript 1.6.2
var Bongo, Broker, KONFIG, argv, extend, mongo, mq, mqOptions, nodePath, projectRoot, webserver;

nodePath = require('path');

Bongo = require('bongo');

Broker = require('broker');

argv = require('optimist').argv;

extend = require('underscore').extend;

KONFIG = require('koding-config-manager').load("main." + argv.c);

mongo = KONFIG.mongo, mq = KONFIG.mq, projectRoot = KONFIG.projectRoot, webserver = KONFIG.webserver;

mqOptions = extend({}, mq);

if ((webserver != null ? webserver.login : void 0) != null) {
  mqOptions.login = webserver.login;
}

mqOptions.productName = 'koding-webserver';

module.exports = new Bongo({
  mongo: mongo,
  root: projectRoot,
  models: 'workers/social/lib/social/models',
  mq: new Broker(mqOptions),
  resourceName: webserver.queueName
});
