{EventEmitter} = require 'events'

module.exports = class ModelLoader extends EventEmitter
  
  constructor:(konstructor, @_id)->
    @constructor = konstructor
    @setMaxListeners(0)
  
  load_ =->
    @constructor.one {@_id}, (err, model)=>
      @emit 'load', err, model
  
  # TODO: I wrote this, but I'm not sure if it makes any sense.
  #   Review this, make sure it works, and doesn't suck. C.T.
  load:(listener)->
    @once 'load', listener
    unless @isLoading
      @isLoading = yes
      load_.call @