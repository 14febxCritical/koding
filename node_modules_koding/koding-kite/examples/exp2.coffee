# this is just an example for a client
{Client, Environment} = require 'koding-kite'
environment = new Environment username: "devrim"

kontrol = new Client environment: environment
kontrol.on 'connected', ()->
  kontrol.getKites {name:"mathworker"}, (err, kites)->
    throw "Error while getting kite list #{err}" if err
    throw "no available kite worker" if not Array.isArray(kites) or kites.length is 0
    # connecting to first avail kite
    mathworker = kites[0]
    mathworker.on 'connected', ()->
      setInterval ()->
        value = Math.random() * 100
        mathworker.callRemote "square", value, (request)->
          [err, data] = request.args
          console.log "square of #{value} is #{data}"
      , 5000
    mathworker.connect()
kontrol.connect()
