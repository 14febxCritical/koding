ServiceManager = require './ServiceManager.coffee'

module.exports = class DomainService extends ServiceManager
  
  # TODO : nameservers should change according to koding.com NS
  nameservers = ["ns29.domaincontrol.in","ns30.domaincontrol.in"]
  avaibleTLDs = ["com","net","org"]
  
  searchDomainAddress:(domainAddress, callback)->
    params =
      "domain-name"        : domainAddress
      "tlds"               : avaibleTLDs
    
    options = 
      service              : "domains"
      action               : "available"
      parameters           : params 

    @makeRequestToResellerApi options, callback

  register:(domain, callback)->
    #invoice option may change, but for now NoInvoice parameter is given, 
    params =
      "domain-name"        : domain.address
      "years"              : domain.years
      "ns"                 : nameservers
      "customer-id"        : domain.customerId
      "reg-contact-id"     : domain.regContactId
      "admin-contact-id"   : domain.adminContactId
      "tech-contact-id"    : domain.techContactId
      "billing-contact-id" : domain.billingContactId
      "invoice-option"     : domain.invoiceOption
      "protect-privacy"    : domain.protectPrivacy
      
    options = 
      service              : "domains"
      action               : "register"
      parameters           : params 

    data = @makeRequestToResellerApi options, callback

  
  getDomainDetails:(domain, callback)->
    params =
      "domain-name"        : domain.address
      "options"            : "All"
             
    options = 
      service              : "domains"
      action               : "details-by-name"
      parameters           : params 

    data = @makeRequestToResellerApi options, callback
    
    
  updateDomainContactDetails:(domain, callback)->
    params =
      "domain-name"        : domain.address
      "options"            : "All"
      "order-id"           : domain.orderId
      "reg-contact-id"     : domain.registrantContactId
      "admin-contact-id"   : domain.adminContactId
      "tech-contact-id"    : domain.techContactId
      "billing-contact-id" : domain.billingContactId
      
    options = 
      service              : "domains"
      action               : "modify-contact"
      parameters           : params 

    data = @makeRequestToResellerApi options, callback
    